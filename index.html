<!DOCTYPE HTML>
<html>
<head>
    <title>EZEMS | HRALTH TECH SYSTEM</title>
    <link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
    <link rel="stylesheet" href="emergency.css">
    <link rel="stylesheet" href="css/ziroh.css">
    <link href='http://fonts.googleapis.com/css?family=Ropa+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/responsiveslides.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="js/responsiveslides.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js"></script>
    <script src="js/ziroh.js"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
   <link rel="icon" href="images/healttech.png" type="image/x-icon">
   <script src="assets/script/index.js"></script>

</head>
<body>
    <div id="emergencyModal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <form id="emergencyForm">
              <label for="senderPhoneNumber">Your Phone Number:</label>
              <input type="text" id="senderPhoneNumber" name="senderPhoneNumber" required><br><br>
      
              <label for="emergencyMessage">Select Emergency Case:</label>
              <select id="emergencyMessage" name="emergencyMessage" required>
                <option value="">Select Emergency Case</option>
                  <option value="Road Accident">Road Accident</option>
                  <option value="Expectant Mother">Expectant Mother</option>
                  <option value="Diabetes">Diabetes</option>
                  <option value="Asthma">Asthma</option>
                  <option value="Heart Attack">Heart Attack</option>
                  <option value="Fire Outbreak">Fire Outbreak</option>
                  <option value="Burglary">Burglary</option>
                  <option value="Medical Emergency">Medical Emergency</option>
                  <option value="Flood">Flood</option>
                  <option value="Earthquake">Earthquake</option>
                  <option value="Child Missing">Child Missing</option>
                  <option value="Poisoning">Poisoning</option>
                  <option value="Severe Allergic Reaction">Severe Allergic Reaction</option>
              </select><br><br>
      
              <button type="button" onclick="sendEmergencyNotification()">Send Emergency Notification</button>
          </form>
        </div>
      </div>
      <div id="sendingMessage" class="sending">Sending...</div>
    <!--start-wrap-->
    
    <!--start-header-->
    <div class="header">
        <div class="wrap">
            <!--start-logo-->
            <div class="logo">
                <a href="index.html" style="font-size: 30px; text-decoration: none;">
                    <img src="images/healttech.png" alt="Ezems Health Tech System Logo" style="vertical-align: middle; height: 40px; margin-right: 10px;">
                    Ezems Health Tech System
                </a>
            </div>
            <!--end-logo-->
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <div class="whatsapp-container rotate-icon">
                <div class="whatsapp-background">
                  <a href="https://wa.me/0101086123" target="_blank">
                    <i class="fab fa-whatsapp whatsapp-icon"></i>
                  </a>
                </div>
              </div>
            <!--start-top-nav-->
            <div class="top-nav">
                <ul>
                    <li class="active"><a href="index.html">Home</a></li>
                    <li><a href="contact.php">Contact</a></li>
                    <li><a href="#" style="background-color: brown; font-size: 16px;" id="emergencyLink">Emergency</a></li>
                </ul>
            </div>
            <div class="clear"> </div>
            <!--end-top-nav-->
        </div>
    </div>
    <!--end-header-->
    <main>
    <!-- Calendar Overlay -->
    <div id="calendar-overlay"></div>

    <!-- Meeting Calendar Popup -->
    <div id="calendar-popup">
        <div id="close-calendar" style="color: red;">X</div>
        <h1>Meeting Calendar</h1>
        <div id="calendar"></div>
    </div>

    <div class="clear"> </div>

    <!--start-image-slider---->
    <div class="image-slider">
        <!-- Slideshow 1 -->
        <ul class="rslides" id="slider1">
            <li><img src="images/slider-image1.jpg" alt=""></li>
            <li><img src="images/slider-image2.jpg" alt=""></li>
            <li><img src="images/slider-image1.jpg" alt=""></li>
        </ul>
        <!-- Slideshow 2 -->
    </div>
    <!--End-image-slider---->
    <div class="clear"> </div>
    <div class="content-grids">
        <div class="wrap">
            <div class="section group">
                <div class="listview_1_of_3 images_1_of_3">
                    <div class="listimg listimg_1_of_2">
                        <img src="images/grid-img3.png">
                    </div>
                    <div class="text list_1_of_2">
                        <h3>Patients</h3>
                        <p>Register & Book Appointment</p>
                        <div class="button"><span><a href="hms/user-login.php">Click Here</a></span></div>
                    </div>
                </div>    

                <div class="listview_1_of_3 images_1_of_3">
                    <div class="listimg listimg_1_of_2">
                        <img src="images/grid-img1.png">
                    </div>
                    <div class="text list_1_of_2">
                        <h3>Doctors Login</h3>
                        <div class="button"><span><a href="hms/doctor/">Click Here</a></span></div>
                    </div>
                </div>

                <div class="listview_1_of_3 images_1_of_3">
                    <div class="listimg listimg_1_of_2">
                        <img src="images/grid-img2.png">
                    </div>
                    <div class="text list_1_of_2">
                        <h3>Admin Login</h3>
                        <div class="button"><span><a href="hms/admin">Click Here</a></span></div>
                    </div>
                </div>            
            </div>
        </div>
    </div>
    <div class="clear"> </div>
    <div class="wrap">
        <div class="content-box">
            <div class="section group">
                <div class="col_1_of_3 span_1_of_3 frist">
                </div>
                <div class="col_1_of_3 span_1_of_3 second">
                </div>
                <div class="col_1_of_3 span_1_of_3 frist">
                </div>
            </div>
        </div>
    </div>
    <div class="clear"> </div>
</main>

  
    <div class="footer">
        <!-- <div class="wrap"> -->
            <center>
                <footer class="Copyright">
                    <p>Ezems Health Tech System, 1333 Kilifi, County, Kenya</p>
                    <p>&copy; 2024 Ezems Health Tech Syst | All Rights Reserved</p>
                    <p>
                        <strong>Follow us on:</strong>
                        <a href="https://www.facebook.com/Ezemstech" target="_blank">Facebook</a>,
                        <a href="https://www.twitter.com/ezems" target="_blank">Twitter</a>,
                        <a href="https://www.instagram.com/ezems" target="_blank">Instagram</a>,
                        <a href="https://www.linkedin.com/in/ziroh-katana-24b23ba9/" target="_blank">LinkedIn</a>,
                        <a href="https://github.com/Tella86/Tella86" target="_blank">GitHub</a>
                    </p>
                    <p><strong>Powered by:</strong> <a href="https://ezems.co.ke" target="_blank"> Ezems Tech Developers</a></p>
                </footer>
            </center>
            
        </div>
        <div class="clear"> </div>
    </div>
    <button id="backToTopBtn" title="Go to top">&#8679;</button>

    <script>
        let mybutton = document.getElementById("backToTopBtn");
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }

        mybutton.onclick = function() {
            document.body.scrollTop = 0; 
            document.documentElement.scrollTop = 0; 
        }
    var modal = document.getElementById("emergencyModal");

var btn = document.getElementById("emergencyLink");

var span = document.getElementsByClassName("close")[0];

var sendingMessage = document.getElementById("sendingMessage");

btn.onclick = function(event) {
    event.preventDefault(); 
    modal.style.display = "block";
}

span.onclick = function() {
    modal.style.display = "none";
}

window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}

function sendEmergencyNotification() {
    var senderPhoneNumber = document.getElementById("senderPhoneNumber").value;
    var emergencyMessage = document.getElementById("emergencyMessage").value;

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            sendPosition(position, senderPhoneNumber, emergencyMessage);
        }, showError);
    } else {
        alert("Geolocation is not supported by this browser.");
    }
}

function sendPosition(position, senderPhoneNumber, emergencyMessage) {
    var latitude = position.coords.latitude;
    var longitude = position.coords.longitude;
    var phoneNumber = '+254101086123'; 

    sendingMessage.style.display = "block";

    var xhr = new XMLHttpRequest();
    xhr.open("POST", "send_notification.php", true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4) {
            sendingMessage.style.display = "none"; 
            if (xhr.status === 200) {
                alert("Emergency notification sent!");
                modal.style.display = "none"; 
            } else {
                alert("Failed to send notification. Please try again.");
            }
        }
    };
    xhr.send("latitude=" + latitude + "&longitude=" + longitude + 
             "&senderPhoneNumber=" + senderPhoneNumber + 
             "&emergencyMessage=" + encodeURIComponent(emergencyMessage) +
             "&phoneNumber=" + phoneNumber);
}

function showError(error) {
    sendingMessage.style.display = "none"; 
    switch(error.code) {
        case error.PERMISSION_DENIED:
            alert("User denied the request for Geolocation.");
            break;
        case error.POSITION_UNAVAILABLE:
            alert("Location information is unavailable.");
            break;
        case error.TIMEOUT:
            alert("The request to get user location timed out.");
            break;
        case error.UNKNOWN_ERROR:
            alert("An unknown error occurred.");
            break;
    }
}
    </script>

    <!--end-wrap-->
</body>
</html>
